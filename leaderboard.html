<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { text-align: center; color: white; background: #121212; font-family: sans-serif; }
        table { width: 90%; max-width: 500px; margin: 20px auto; border-collapse: collapse; }
        th, td { padding: 10px; border-bottom: 1px solid #333; }
        th { color: var(--accent, gold); }
        .rank-1 { color: gold; font-weight: bold; }
        .rank-2 { color: silver; font-weight: bold; }
        .rank-3 { color: #cd7f32; font-weight: bold; }
    </style>
</head>
<body>
    <h1 style="margin-top: 30px; color: var(--accent, #f1c40f);">HALL OF FAME</h1>
    
    <div style="margin-bottom: 20px;">
        <button class="btn" onclick="loadRank('EASY')">EASY</button>
        <button class="btn" onclick="loadRank('NORMAL')">NORMAL</button>
        <button class="btn" onclick="loadRank('HARD')">HARD</button>
        <button class="btn" onclick="loadRank('HELL')">HELL</button>
    </div>

    <h3 id="current-mode" style="color:#888;">LOADING...</h3>

    <table>
        <thead>
            <tr>
                <th width="15%">#</th>
                <th width="50%">NAME</th>
                <th width="35%">BEST BLOCK</th>
                </tr>
        </thead>
        <tbody id="rank-list">
            </tbody>
    </table>

    <button class="btn" style="margin-top: 30px; background: #444;" onclick="location.href='/'">ğŸ  MAIN MENU</button>

    <script type="module">
        import { getLeaderboardData } from "./js/game-core.js";

        window.loadRank = async (diff) => {
            document.getElementById('current-mode').textContent = `- ${diff} MODE -`;
            const list = document.getElementById('rank-list');
            list.innerHTML = '<tr><td colspan="3">Loading...</td></tr>'; 

            // ì „ì²´ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (limit ì—†ìŒ)
            const data = await getLeaderboardData(diff);
            
            list.innerHTML = '';
            if(data.length === 0) {
                list.innerHTML = '<tr><td colspan="3" style="color:#666;">No Records Yet</td></tr>';
                return;
            }

            data.forEach((item, index) => {
                const rankClass = index === 0 ? 'rank-1' : (index === 1 ? 'rank-2' : (index === 2 ? 'rank-3' : ''));
                
                // ìŠ¤íƒ€ í‘œì‹œ ì œì™¸í•˜ê³  ë Œë”ë§
                const row = `
                    <tr class="${rankClass}">
                        <td>${index + 1}</td>
                        <td>${item.username}</td>
                        <td style="font-size:1.2rem; font-weight:bold;">${item.bestChar}</td>
                    </tr>
                `;
                list.innerHTML += row;
            });
        };

        // ê¸°ë³¸ ì‹¤í–‰ (NORMAL ëª¨ë“œ)
        window.onload = () => loadRank('NORMAL');
    </script>
</body>
</html>
