<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alpha-Z Leaderboard</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ë¦¬ë”ë³´ë“œ ì „ìš© ìŠ¤íƒ€ì¼ */
        .rank-container {
            width: 95%;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #444;
            height: 80vh;
            display: flex;
            flex-direction: column;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-btn {
            flex: 1;
            padding: 10px;
            background: #333;
            border: 1px solid #555;
            color: #aaa;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .tab-btn.active {
            background: var(--accent); /* ë…¸ë€ìƒ‰ */
            color: #000;
            border-color: var(--accent);
            box-shadow: 0 0 10px rgba(241,196,15,0.5);
        }

        .rank-scroll {
            flex: 1;
            overflow-y: auto;
            border: 1px solid #444;
            border-radius: 8px;
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            color: #fff;
            font-size: 0.95rem;
        }

        th {
            background: #222;
            padding: 12px;
            position: sticky;
            top: 0;
            text-align: center;
            border-bottom: 2px solid #555;
            font-weight: bold;
            color: var(--accent);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #333;
            text-align: center;
        }

        tr:nth-child(even) { background: rgba(255,255,255,0.03); }
        
        /* 1, 2, 3ë“± ê°•ì¡° */
        tr:nth-child(1) td:first-child { color: gold; font-size: 1.2rem; }
        tr:nth-child(2) td:first-child { color: silver; font-size: 1.1rem; }
        tr:nth-child(3) td:first-child { color: #cd7f32; font-size: 1.1rem; }

        .loading-text { text-align: center; padding: 20px; color: #888; }
        
        /* ëŒì•„ê°€ê¸° ë²„íŠ¼ */
        .back-btn {
            margin-top: 15px;
            width: 100%;
            padding: 12px;
            background: #444;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
        }
    </style>
</head>
<body class="main-bg" style="display:block; padding-top:20px;">

    <h1 style="text-align:center; color:white; margin-bottom:20px; text-shadow:0 0 10px black;">ğŸ† HALL OF FAME</h1>

    <div class="rank-container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="loadTab('EASY')">EASY</button>
            <button class="tab-btn" onclick="loadTab('NORMAL')">NORMAL</button>
            <button class="tab-btn" onclick="loadTab('HARD')">HARD</button>
            <button class="tab-btn" onclick="loadTab('HELL')">HELL</button>
        </div>

        <div class="rank-scroll">
            <table id="rank-table">
                <thead>
                    <tr>
                        <th width="15%">#</th>
                        <th width="40%">NAME</th>
                        <th width="20%">BLOCK</th>
                        <th width="25%">STARS</th>
                    </tr>
                </thead>
                <tbody id="rank-body">
                    </tbody>
            </table>
            <div id="loading" class="loading-text">Loading...</div>
        </div>

        <button class="back-btn" onclick="location.href='index.html'">â¬… BACK TO GAME</button>
    </div>

    <script type="module">
        import * as Core from "./js/game-core.js";

        // í˜„ì¬ ì„ íƒëœ íƒ­ (ê¸°ë³¸ê°’ EASY)
        let currentTab = 'EASY';

        // íƒ­ ë³€ê²½ í•¨ìˆ˜ (ì „ì—­ ë“±ë¡)
        window.loadTab = function(diff) {
            currentTab = diff;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.textContent === diff) btn.classList.add('active');
            });

            fetchData();
        }

        async function fetchData() {
            const tbody = document.getElementById('rank-body');
            const loading = document.getElementById('loading');
            
            tbody.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”
            loading.style.display = 'block'; // ë¡œë”© í‘œì‹œ

            // Coreì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const data = await Core.getLeaderboardData(currentTab);
            
            loading.style.display = 'none'; // ë¡œë”© ìˆ¨ê¹€

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="padding:20px; color:#666;">No records yet.</td></tr>';
                return;
            }

            // í…Œì´ë¸”ì— í–‰(Row) ì¶”ê°€
            data.forEach((item, index) => {
                const tr = document.createElement('tr');
                
                // ìˆœìœ„, ì´ë¦„, ìµœê³ ë¸”ë¡, ë³„
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td style="color:white; font-weight:bold;">${item.username || 'Unknown'}</td>
                    <td><span class="cell b-${item.bestChar}" style="width:30px; height:30px; font-size:1rem; display:inline-flex; border-radius:4px;">${item.bestChar}</span></td>
                    <td style="color:#f1c40f;">â­ ${item.stars}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°”ë¡œ ì‹¤í–‰
        window.onload = () => loadTab('EASY');
    </script>
</body>
</html>
